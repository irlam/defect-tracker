{
	// .devcontainer/devcontainer.json
	// VS Code Dev Container configuration for the Defect Tracker project
	// This file configures a containerized development environment with PHP, MySQL, and Adminer
	// Created: 26th January 2025
	
	"name": "Defect Tracker Development Environment",
	"dockerComposeFile": "../docker-compose.yml",
	"service": "web",
	"workspaceFolder": "/var/www/html",
	"shutdownAction": "stopCompose",

	// Ensure both web and database services are started
	"runServices": ["web", "db", "adminer"],

	// Forward ports for development
	"forwardPorts": [
		8000,  // Web application (Apache)
		8080,  // Adminer database management
		3306   // MySQL database direct access
	],
	"portsAttributes": {
		"8000": {
			"label": "Web Application",
			"onAutoForward": "notify"
		},
		"8080": {
			"label": "Adminer (Database Admin)",
			"onAutoForward": "silent"
		},
		"3306": {
			"label": "MySQL Database",
			"onAutoForward": "silent"
		}
	},

	// Set the remote user to match the container's web server user
	"remoteUser": "www-data",

	// Customizations for VS Code
	"customizations": {
		"vscode": {
			// Install helpful extensions for PHP development
			"extensions": [
				"bmewburn.vscode-intelephense-client",  // PHP IntelliSense
				"xdebug.php-debug",                     // PHP debugging
				"ms-vscode.vscode-docker",              // Docker support
				"eamodio.gitlens",                      // Git enhanced features
				"bradlc.vscode-tailwindcss",            // Tailwind CSS (if used)
				"formulahendry.auto-rename-tag",        // HTML tag renaming
				"ms-vscode.vscode-json"                 // JSON support
			],
			
			// VS Code settings optimized for PHP development
			"settings": {
				// PHP configuration
				"php.suggest.basic": false,
				"php.validate.enable": true,
				"php.validate.executablePath": "/usr/local/bin/php",
				
				// Intelephense configuration
				"intelephense.diagnostics.enable": true,
				"intelephense.completion.triggerParameterHints": true,
				"intelephense.completion.insertUseDeclaration": true,
				"intelephense.format.enable": true,
				
				// File associations
				"files.associations": {
					"*.php": "php",
					"*.inc": "php"
				},
				
				// Editor settings
				"editor.tabSize": 4,
				"editor.insertSpaces": true,
				"editor.formatOnSave": false,
				
				// Terminal settings
				"terminal.integrated.defaultProfile.linux": "bash",
				
				// Git settings
				"git.enableCommitSigning": false
			}
		}
	},

	// Commands to run after container creation
	"postCreateCommand": "composer install && echo 'Dev container setup complete! Open http://localhost:8000 to view the application.'",

	// Mount additional volumes for persistent data
	"mounts": [
		"source=${localWorkspaceFolder}/logs,target=/var/www/html/logs,type=bind,consistency=cached",
		"source=${localWorkspaceFolder}/uploads,target=/var/www/html/uploads,type=bind,consistency=cached"
	],

	// Features to install (none needed for this setup)
	"features": {},

	// Environment variables for development
	"containerEnv": {
		"XDEBUG_MODE": "develop,debug",
		"XDEBUG_CONFIG": "client_host=host.docker.internal client_port=9003",
		"PHP_IDE_CONFIG": "serverName=localhost"
	}
}